{% import 'dns.jinja2' as dns with context %}

{{ dns.TTL(item.ttl) }}

{{ dns.SOA(dns.domain(item.nameservers[0]+item.domain), dns.domain('hostmaster.'+item.domain)) }}

{% for ns in item.nameservers %}
{{ dns.NS(dns.domain(ns)) }}
{% endfor %}

{% if item.MX is defined %}
{% for mx in item.MX %}
{% if mx is mapping %}
{{
  dns.MX(
    dns.domain(item.domain) if name not in mx else mx.name,
    mx.value,
    10 if priority not in mx else mx.priority)
}}
{% else %}
{{
  dns.MX(
    dns.domain(item.domain),
    mx)
}}
{% endif %}
{% endfor %}
{% endif %}

{% if item.A is defined %}
{% for name,ip in item.A.items() %}
{{ dns.A(name, ip) }}
{% endfor %}
{% endif %}

{% if item.CNAME is defined %}
{% for name, cname in item.CNAME.items() %}
{{ dns.CNAME(name, cname) }}
{% endfor %}
{% endif %}
